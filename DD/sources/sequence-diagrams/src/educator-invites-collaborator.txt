title Educator invites a collaborator

participant Logged educator
participant WebApplication
participant EducatorManager
participant TournamentManager
participant InformationProvider

participant UserInformation

participant NotificationService

participant MailService

participant DatabaseService
participant DataBase

Logged educator->WebApplication:getTournamentPage
note over Logged educator: The procedure for reaching a\nspecific tournament page is specified\nin a previous sequence diagram
WebApplication-->Logged educator: tournament page
Logged educator->WebApplication: addCollaborator(tournamentID: int)
WebApplication->EducatorManager:addCollaborator(educatorID: int, tournamentID: int)
EducatorManager->TournamentManager:addCollaborator(educatorID: int, tournamentID: int)
TournamentManager->DatabaseService:addCollaborator(educatorID: int, tournamentID: int)
DatabaseService->DataBase:addCollaborator(educatorID: int, tournamentID: int)
DataBase-->DatabaseService: result: boolean, tournamentID: int
DatabaseService-->TournamentManager:result: boolean, tournamentID: int
TournamentManager-->EducatorManager:result: boolean, tournamentID: int
EducatorManager-->WebApplication:result: boolean, tournamentID: int
alt !result
WebApplication-->Logged educator:errorPage
else result
WebApplication-->Logged educator: new collaborator page
loop selected educator is already an admin || error while sending the invitation
loop educator inserts a new character in the search bar
alt educator updates the search criteria
Logged educator->WebApplication:searchEducator(educatorName: String)
WebApplication->InformationProvider:searchEducator(educatorName: String)
InformationProvider->UserInformation:searchEducator(educatorName: String)
UserInformation->DatabaseService:searchEducator(educatorName: String)
DatabaseService->DataBase:searchEducator(educatorName: String)
DataBase-->DatabaseService:educatorList: List<Educator>
DatabaseService-->UserInformation:educatorList: List<Educator>
UserInformation-->InformationProvider:educatorList: List<Educator>
InformationProvider-->WebApplication:educatorList: List<Educator>
WebApplication->WebApplication:toJson(educatorList: List<Educator>)
WebApplication-->Logged educator:educatorList: JSON


else educator finds the user he was looking for
Logged educator->WebApplication:inviteForCollaboration(username: String, tournamentID: int)
WebApplication->EducatorManager:inviteForCollaboration(educatorID: int, username: String, tournamentID: int)
EducatorManager->TournamentManager:inviteForCollaboration(educatorID: int, username: String, tournamentID: int)
TournamentManager->DatabaseService:inviteForCollaboration(educatorID: int, username: String, tournamentID: int)
DatabaseService->DataBase: inviteForCollaboration(educatorID: int, username: String, tournamentID: int))
DataBase-->DatabaseService: result: boolean, educator: Educator, tournamentID: int
DatabaseService-->TournamentManager:result: boolean, educator: Educator, tournamentID: int
TournamentManager-->EducatorManager:result: boolean, educator: Educator, tournamentID: int

alt !result
EducatorManager-->WebApplication:result: boolean
WebApplication-->Logged educator:already a collaborator error
else result
EducatorManager->NotificationService:inviteForCollaboration(educator: Educator, tournamentID: int)
NotificationService->MailService: inviteForCollaboration(educator: Educator, tournamentID: int)
loop the value of "result" is true || three false "result" in a row
NotificationService->DatabaseService:addNotificationForCollaboration(username: String,tournamentID: int)
DatabaseService->DataBase: addNotificationForCollaboration(username: String,tournamentID: int)
DataBase-->DatabaseService: result: boolean
DatabaseService-->NotificationService:result: boolean
alt result == true
NotificationService->MailService:sendEmailForCollaboration(email: String,tournamentID: int)
end
end

NotificationService-->EducatorManager:result: boolean
EducatorManager-->WebApplication: result: boolean
alt !result
WebApplication-->Logged educator: errorPage
else result
WebApplication-->Logged educator: Educator invitation was successful
end

end


end

end
end
end


